@echo off
chcp 65001 > nul
title ๐ค ุจูุช ุฅุฏุงุฑุฉ ุงูุญุณุงุจุงุช ุงููุงููุฉ ุงูุญุฏูุซ
echo ========================================
echo   ๐ค  ุชุดุบูู ุจูุช ุฅุฏุงุฑุฉ ุงูุญุณุงุจุงุช ุงููุงููุฉ ุงูุญุฏูุซ
echo ========================================
echo.

cd /d "C:\Users\Admin\finance"

REM ุงูุชุญูู ูู ูุฌูุฏ ููู ุงูุจูุฆุฉ
if not exist ".env" (
    echo โ ููู .env ุบูุฑ ููุฌูุฏ!
    echo ๐ ูุฑุฌู ุฅูุดุงุก ููู .env ูุฅุถุงูุฉ ุงูุชููู
    echo.
    pause
    exit
)

REM ุงูุชุญูู ูู ุชุซุจูุช ุจุงูุซูู
python --version > nul 2>&1
if errorlevel 1 (
    echo โ ุจุงูุซูู ุบูุฑ ูุซุจุช ุฃู ุบูุฑ ูุถุงู ุฅูู PATH
    echo ๐ ูุฑุฌู ุชุซุจูุช ุจุงูุซูู ูู python.org
    echo.
    pause
    exit
)

REM ุงูุชุญูู ูู ุชุซุจูุช ุงููุชุทูุจุงุช
python -c "import telegram" > nul 2>&1
if errorlevel 1 (
    echo ๐ฆ ุฌุงุฑู ุชุซุจูุช ุงููุชุทูุจุงุช...
    pip install python-telegram-bot pandas openpyxl python-dotenv
    echo.
)

echo ๐ ุฌุงุฑู ุชุดุบูู ุงูุจูุช...
echo ๐ ุงุถุบุท Ctrl+C ูุฅููุงู ุงูุจูุช
echo.

REM ุชุดุบูู ุงูุจูุช ูุจุงุดุฑุฉ (ุจุฏูู main.py)
python finance.py

echo.
echo ========================================
echo   โน๏ธ  ุชู ุฅููุงู ุงูุจูุช
echo ========================================
pause